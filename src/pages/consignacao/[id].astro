---
// src/pages/consignacao/[id].astro
import DashboardLayout from '../../layouts/DashboardLayout.astro';
import ItemConsignacaoDetalhes from '../../components/consignacao/ItemConsignacaoDetalhes';
import type { ItemConsignacao, Fornecedor } from '../../types';

import { getItensConsignados, getFornecedores } from '../../lib/db'; // <-- Importe as funções

// getStaticPaths é necessário para rotas dinâmicas em Astro
export async function getStaticPaths() {
  // --- CHAME A FUNÇÃO ASSÍNCRONA DE FETCH AQUI ---
  const itens = await getItensConsignados(); // <--- CHAME A FUNÇÃO!
  // --- FIM DA CHAMADA ---

  return itens.map(item => ({
    params: { id: item.id },
    // props: { item }, // <--- NÃO PRECISA MAIS PASSAR O ITEM COMO PROP
  }));
}
const { id } = Astro.params;
---

<DashboardLayout title={`Detalhes do Item ${id.substring(0, 8)}`}>
  <h1 class="text-3xl font-bold mb-8">
    Item Consignado
  </h1>
  
  <ItemConsignacaoDetalhes client:load itemId={id!} />
</DashboardLayout>