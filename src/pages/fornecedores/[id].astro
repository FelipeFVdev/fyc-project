---
// src/pages/fornecedores/[id].astro
import DashboardLayout from '../../layouts/DashboardLayout.astro';
import VisualizarFornecedor from '../../components/fornecedores/VisualizarFornecedor';

// --- IMPORTAR A FUNÇÃO DE FETCH, NÃO O MOCK DIRETO ---
import { getFornecedores } from '../../lib/db'; // <-- Importe a função getFornecedores()
// --- FIM DA IMPORTAÇÃO ---


// getStaticPaths para gerar páginas para cada fornecedor
export async function getStaticPaths() {
  // --- CHAME A FUNÇÃO ASSÍNCRONA DE FETCH AQUI ---
  const fornecedores = await getFornecedores(); // <--- CHAME A FUNÇÃO!
  // --- FIM DA CHAMADA ---

  return fornecedores.map(fornecedor => ({
    params: { id: fornecedor.id },
  }));
}

const { id } = Astro.params;
---

<DashboardLayout title={`Fornecedor: ${id}`}>
  <VisualizarFornecedor client:load fornecedorId={id!} />
</DashboardLayout>